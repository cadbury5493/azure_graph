index=ssc_inspec_event_idx bunit=awscentral_qualys
| stats 
    count AS total_controls,
    count(eval(Status="Failed")) AS failed_controls
    BY "Host IP" Technology "DNS Hostname"
| eval compliant_controls = total_controls - failed_controls
| eval compliance_percentage = round((compliant_controls / total_controls) * 100, 2)
| rename Technology AS platform "DNS Hostname" AS host_name
| table "Host IP" host_name platform total_controls failed_controls compliance_percentage
