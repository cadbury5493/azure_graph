Hi Vignesh,

During our bi-weekly catch-up, we discussed the need for granular control-level reporting. I’ve documented the details along with an example in the attached document — please have a look.

As discussed, we require sub-control level results because the GCS team provides waivers at a granular level. AWS SSM already generates results in a granular format, which makes it significantly easier to:

Map waivers accurately

Avoid incorrect non-compliance reporting

Maintain audit traceability

Azure Reporting Alignment

We may also need to revisit Azure reporting. Currently, Azure provides non-granular reports. This did not surface earlier because:

Most Azure controls were passing

Instances were compliant

Waivers applied in Azure did not use alphanumeric sub-control mapping

However, if we want to standardize reporting across platforms, granular reporting should be the target format, and Azure reporting may need to be aligned accordingly.

Pending Tasks – AWS SSM POC (Priority Order)

Upload granular report to S3 after CIS profile execution

No additional development required; the report is already generated on the VM and only needs to be uploaded to S3.

Logic to handle multiple control executions dynamically

DM018

CIS Profiles

Rollout across business units

AWSCentral

CRDPM

BestX

Chef licensing compatibility validation

Q1 Goal – DM018 Implementation

As part of our Q1 objectives, we need to implement the DM018 solution on AWSCentral. The Central team is currently waiting for the POC to be completed.

Could you please provide an estimated timeline (ETA) for completion?

Note:
We have implemented a tactical AWS SSM-based solution for BestX and CRDPM. However, AWSCentral deployment is pending completion of the POC.

Happy to set up a call to discuss further.
---
Hi Raj,

I hope you’re doing well.

As you’re aware, we have completed the DM018 scanning across all BestX hosts.

Following up on our earlier discussion regarding the implementation of the CIS scanning solution for BestX, I would like to seek your approval to involve Sudhakar in this activity. The implementation is expected to take approximately one week to complete. Once done, we will be able to scan the BestX hosts against CIS compliance standards and proceed with necessary remediation actions.

Additionally, I wanted to check whether there is a way to specifically identify BestX CIs in the CMDB. If this is currently not feasible, could you please include us in the inventory email that is shared with other teams? This will help us ensure complete coverage and accurate tracking.

Please let me know your thoughts.

Thank you.



---
index=ssc_inspec_event_idx exec_mode=weekly_cis_unix bunit=gis
| stats
    count as total_hosts_scanned
    count(eval(status="passed")) as total_hosts_passed
    count(eval(status="failed")) as total_hosts_failed

---
index=ssc_inspec_event_idx exec_mode=weekly_ssc_dm018
| spath output=outer_status path=status
| spath output=bunit path=bunit
| spath output=platform path=platfprm
| stats 
    latest(outer_status) as host_status
    latest(bunit) as bunit
    latest(platform) as platform
    by host_name
| stats
    count as total_hosts_scanned
    count(eval(host_status="passed")) as total_hosts_passed
    count(eval(host_status="failed")) as total_hosts_failed
    by platform
| sort - total_hosts_scanned

---
index=ssc_inspec_event_idx exec_mode=weekly_ssc_dm018
| spath output=outer_status path=status
| spath output=bunit path=bunit
| stats 
    latest(outer_status) as host_status
    latest(bunit) as bunit
    by host_name
| stats
    count as total_hosts_scanned
    count(eval(host_status="passed")) as total_hosts_passed
    count(eval(host_status="failed")) as total_hosts_failed
    by bunit
| sort - total_hosts_scanned

---
index=ssc_inspec_event_idx bunit=awscentral_qualys
| stats 
    count AS total_controls,
    count(eval(Status="Passed")) AS passed_controls,
    count(eval(Status="Skipped")) AS skipped_controls
    BY "Host IP" "DNS Hostname"

| eval passed_skipped_controls = passed_controls + skipped_controls

| eval host_compliance_pct = round(
    (passed_skipped_controls / total_controls) * 100,
    2
)

| eval is_compliant_95 = if(host_compliance_pct > 95, 1, 0)

| stats
    sum(is_compliant_95) AS passing_hosts
    count AS hosts_scanned

| eval overall_compliance_pct = round(
    (passing_hosts / hosts_scanned) * 100,
    2
)

| fields overall_compliance_pct
---
index=ssc_inspec_event_idx bunit=awscentral_qualys
| stats 
    count AS total_controls
    BY "Host IP" "DNS Hostname"

| eval host_key = 'Host IP' . "||" . 'DNS Hostname'

| stats
    dc(host_key) AS total_hosts_scanned


---
index=ssc_inspec_event_idx bunit=awscentral_qualys
| stats 
    count AS total_controls,
    count(eval(Status="Passed")) AS passed_controls,
    count(eval(Status="Failed")) AS failed_controls,
    count(eval(Status="Skipped")) AS skipped_controls
    BY "Host IP" Technology "DNS Hostname"

| eval passed_skipped_controls = passed_controls + skipped_controls

| eval compliance_pct = round(
    (passed_skipped_controls / total_controls) * 100,
    2
)

| eval is_compliant_95 = if(compliance_pct > 95, "true", "false")

| eval host_key = 'Host IP' . "||" . 'DNS Hostname'

| stats
    dc(host_key) AS hosts_scanned
    count(eval(is_compliant_95="true")) AS passing_hosts
    count(eval(is_compliant_95="false")) AS failing_hosts
    BY Technology

| eval compliance_pct = round(
    (passing_hosts / hosts_scanned) * 100,
    2
)

| rename Technology AS platform

| table
    platform
    hosts_scanned
    passing_hosts
    failing_hosts
    compliance_pct






----
index=ssc_inspec_event_idx bunit=awscentral_qualys
| stats 
    count AS total_controls,
    count(eval(Status="Passed")) AS passed_controls,
    count(eval(Status="Failed")) AS failed_controls,
    count(eval(Status="Skipped")) AS skipped_controls
    BY "Host IP" Technology "DNS Hostname"

| eval passed_skipped_controls = passed_controls + skipped_controls

| eval compliance_percentage = round(
    (passed_skipped_controls / total_controls) * 100,
    2
)

| eval compliance_percentage_considering_skipped_as_failed = round(
    (passed_controls / total_controls) * 100,
    2
)

| eval is_compliant_95 = if(compliance_percentage > 95, "true", "false")

| rename Technology AS platform "DNS Hostname" AS host_name

| table 
    "Host IP"
    host_name
    platform
    total_controls
    passed_skipped_controls
    failed_controls
    compliance_percentage
    passed_controls
    skipped_controls
    compliance_percentage_considering_skipped_as_failed
    is_compliant_95

---
index=ssc_inspec_event_idx exec_mode=weekly_ssc_dmn018
| spath output=outer_status path=status
| spath path=results{} output=results
| mvexpand results
| spath input=results
| stats 
    dc(host_name) as total_hosts_scanned
    count(eval(outer_status="passed")) as total_controls_passed
    count(eval(outer_status="failed")) as total_controls_failed


---
index=ssc_inspec_event_idx exec_mode=weekly_ssc_dm018
| spath path=results{} output=results
| mvexpand results
| spath input=results
| stats 
    dc(host_name) as total_hosts_scanned
    count(eval(status="passed")) as total_controls_passed
    count(eval(status="failed")) as total_controls_failed
    by platfprm
| rename platfprm as platform
| sort - total_hosts_scanned

---
index=ssc_inspec_event_idx exec_mode=weekly_ssc_dm018 | spath output=outer_status path=status | spath path=results{} output=results | mvexpand results | spath input=results | eval reason=if(status=="failed", code_desc, null()) | stats values(reason) as failed_reasons values(platfprm) as platform values(environment) as environment values(outer_status) as outer_status by host_name | eval failed_reasons=if(isnull(failed_reasons), "None", mvjoin(failed_reasons, " || ")) | table host_name platform environment outer_status failed_reasons
